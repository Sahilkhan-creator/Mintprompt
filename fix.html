<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fix Prompt – MintPrompt</title>

<style>
:root {
  --primary: #6a5cff;
  --bg: #0f1020;
  --card: #171830;
  --text: #ffffff;
  --muted: #b8b8d6;
}

body {
  margin: 0;
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, #0f1020, #14163a);
  color: var(--text);
}

header {
  padding: 16px 24px;
  font-size: 1.3rem;
  font-weight: 700;
  background: rgba(0,0,0,0.3);
}

.container {
  max-width: 900px;
  margin: 40px auto;
  padding: 20px;
}

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.4);
}

h1 {
  margin-top: 0;
}

textarea {
  width: 100%;
  min-height: 140px;
  border-radius: 12px;
  border: none;
  padding: 16px;
  font-size: 1rem;
  background: #0f1020;
  color: white;
  resize: vertical;
}

button {
  margin-top: 16px;
  padding: 14px 26px;
  border-radius: 30px;
  border: none;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 600;
  background: linear-gradient(135deg, #6a5cff, #8e7bff);
  color: white;
  transition: 0.3s;
}

button:hover {
  transform: translateY(-2px);
}

.output {
  margin-top: 30px;
  display: none;
}

.output-box {
  background: #0f1020;
  padding: 18px;
  border-radius: 12px;
  font-size: 0.95rem;
  line-height: 1.6;
}

.copy-btn {
  background: transparent;
  color: var(--primary);
  border: 1px solid var(--primary);
  margin-left: 10px;
}

.loader {
  margin-top: 20px;
  display: none;
  color: var(--muted);
}
</style>
</head>

<body>

<header>MintPrompt – Fix Prompt</header>

<div class="container">
  <div class="card">
    <h1>Fix Your AI Prompt</h1>
    <p class="muted">
      Improve clarity, structure, style, and quality of your existing prompt.
    </p>

    <textarea id="inputPrompt" placeholder="Paste your weak or messy prompt here..."></textarea>

    <br>
    <button onclick="fixPrompt()">Fix Prompt</button>

    <div class="loader" id="loader">Improving your prompt…</div>

    <div class="output" id="output">
      <h3>Improved Prompt</h3>
      <div class="output-box" id="result"></div>
      <button class="copy-btn" onclick="copyResult()">Copy Prompt</button>
    </div>
  </div>
</div>

<script>
/* ===== Prompt Knowledge Base ===== */
const STYLES = {
  cinematic: ["cinematic", "movie still", "film scene"],
  anime: ["anime", "manga", "japanese style"],
  realistic: ["realistic", "photorealistic", "ultra realistic"],
  illustration: ["illustration", "digital art", "concept art"]
};

const LIGHTING = {
  studio: ["studio lighting", "soft light", "key light"],
  dramatic: ["dramatic lighting", "high contrast", "rim light"],
  natural: ["sunlight", "golden hour", "natural light"],
  night: ["night", "moonlight", "neon light"]
};

const ENVIRONMENTS = [
  "studio", "city", "forest", "beach", "room",
  "cyberpunk city", "space", "desert", "mountains"
];

const CAMERA = [
  "close-up", "wide angle", "portrait shot",
  "shallow depth of field", "bokeh background"
];

/* ===== Utilities ===== */
function findMatches(text, source) {
  return Object.keys(source).find(key =>
    source[key].some(word => text.includes(word))
  );
}

function findListMatch(text, list) {
  return list.find(word => text.includes(word));
}

/* ===== Core Fix Engine ===== */
function fixPrompt() {
  const inputRaw = document.getElementById("inputPrompt").value.trim();
  if (!inputRaw) return alert("Please enter a prompt");

  document.getElementById("loader").style.display = "block";
  document.getElementById("output").style.display = "none";

  setTimeout(() => {
    const input = inputRaw.toLowerCase();

    /* Stage 1: Subject inference */
    const subject = inputRaw.split(",")[0];

    /* Stage 2: Classification */
    const styleKey = findMatches(input, STYLES) || "cinematic";
    const lightKey = findMatches(input, LIGHTING) || "studio";
    const environment = findListMatch(input, ENVIRONMENTS) || "clean studio background";
    const camera = findListMatch(input, CAMERA) || "portrait shot";

    /* Stage 3: Conflict resolution */
    const finalLighting =
      lightKey === "night" && input.includes("sun")
        ? "moody night lighting"
        : LIGHTING[lightKey][0];

    /* Stage 4: Context-aware defaults */
    const contextBoost =
      subject.includes("person") || subject.includes("portrait")
        ? "natural skin tones, detailed facial features"
        : "sharp textures, realistic materials";

    /* Stage 5: Prompt expansion */
    const enhancedPrompt = [
      subject,
      `Environment: ${environment}`,
      `Style: ${STYLES[styleKey][0]}, ultra-detailed`,
      `Lighting: ${finalLighting}`,
      `Camera: ${camera}`,
      contextBoost,
      "8k resolution, professional composition, high dynamic range",
      "Negative prompt: low quality, blur, distortion, watermark, extra limbs, bad anatomy"
    ].join(", ");

    /* Stage 6: Output */
    document.getElementById("result").innerText = enhancedPrompt;
    document.getElementById("loader").style.display = "none";
    document.getElementById("output").style.display = "block";
  }, 1200);
}

function copyResult() {
  navigator.clipboard.writeText(document.getElementById("result").innerText);
  alert("Prompt copied!");
}
</script>
